{
  "hash": "eebefe3a0f096288d592c6a6d3412f1c",
  "result": {
    "markdown": "---\ntitle: \"Lecture 9: Confidence Intervals\"\nsubtitle: \"BIOS 600 - Fall 2024\"\nauthor: \"Kara McCormack\"\nlogo: \"images/logo_600.png\"\nformat: \n  revealjs: \n    theme: slides.scss\n    multiplex: true\n    transition: fade\n    slide-number: true\neditor: visual\nexecute:\n  freeze: auto\nfrom: markdown+emoji\n---\n\n\n\n## Optional readings\n\n- P & G: Chapter 9\n\n- OpenIntro: No corresponding section.\n\n## The opioid crisis\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/lec-9/wv.png){width=800}\n:::\n\n::: {.column width=\"50%\"}\n\n- West Virginia has the highest age-adjusted rate of drug overdose deaths involving opioids. \n:::\n\n:::\n\n## Statistical inference {.smaller}\n\n- [Point estimation]{style=\"color: RosyBrown\"}: estimating an unknown parameter using a single number calculated from the sample\n  - We estimate the one-year death rate due to opioid-related overdoses in WV to be 49.6 per 100,000\n\n- [Interval estimation]{style=\"color: RosyBrown\"}: estimating an unknown parameter using a range of values that is likely to contain the true parameter\n\n  - We estimate that the one-year death rate due to opioid-related overdoses in WV is between 45 and 55 per 100,000\n\n- [Hypothesis testing]{style=\"color: RosyBrown\"}: evaluating whether our observed sample data provides evidence against some population claim\n  - We evaluate the hypothesis that the opioid overdose death rate is the same in WV and NC. In a random sample of death certificates from the two states, the rate was considerably higher in WV, providing evidence against the hypothesis\n  \n\n## Why should we care about confidence interval estimation?\n\n![](images/lec-9/xkcd.png)\n\nRandlall Munroe, xkcd\n\n## What is a confidence interval, anyway?\n\n- A [confidence interval]{style=\"color: RosyBrown\"} gives a range of values that is intended to cover the parameter of interest to a certain degree of \"confidence\"\n\n- Confidence interval = [point estimate]{style=\"color: RosyBrown\"} $\\pm$ [margin of error]{style=\"color: RosyBrown\"}\n\n## How do you interpret a confidence interval? {.smaller}\n\n![](images/lec-9/asthma.png){width=600}\n\n- Researchers conducted a clinical trial of a drug intended for severe asthma patients. Their primary endpoint was evaluating whether the mean rate of asthma exacerbation over 48 weeks was different between placebo and treatment arms. \n- Above is the 95% confidence interval for the mean rate among the placebo patients.\n\n- How do you interpret this interval? (more on this very soon!)\n\n## Brief caveat\n\n- For now, let's assume that we know $\\sigma$ (this rarely ever happens)\n\n## Two-sided confidence intervals\n\n- Given a random variable $X$ with mean $\\mu$ and standard deviation $\\sigma$, the CLT tells us that \n\n$$Z = \\frac{\\bar X - \\mu}{\\sigma / \\sqrt{n}}$$,\n\nwhere $Z$ has a standard normal distribution if $X$ is normal, and $Z$ is approximately normal if $X$ is not normal, but $n$ is large enough.\n\n- Recall: rule of thumb $n > 30$.\n\n## Deriving the two-sided interval\n\n- For a standard normal random variable, 95% of the observations lie between -1.96 and 1.96 for $Z \\sim N(0,1)$, so\n\n$$0.95 = P(-1.96 \\leq Z \\leq 1.96)$$\n\n- So, a 95% CI is given by\n\n$$(\\bar X - 1.96 \\frac{\\sigma}{\\sqrt n}, \\bar X + 1.96 \\frac{\\sigma}{\\sqrt n})$$\n\n::: {.callout-caution appearance=\"simple\"}\n\n## Question\n\nHow did we get this?\n\n:::\n\n## Generic form of confidence intervals\n\n$$(\\bar X - 1.96 \\frac{\\sigma}{\\sqrt n}, \\bar X + 1.96 \\frac{\\sigma}{\\sqrt n})$$\n\nPoint estimate $\\pm$ [confidence multiplier]{style=\"color: RosyBrown\"} $\\times$ standard error\n\n- The confidence multiplier $\\times$ standard error is known as the [margin of error]{style=\"color: RosyBrown\"}\n\n## CI interpretation\n\n$$(\\bar X - 1.96 \\frac{\\sigma}{\\sqrt n}, \\bar X + 1.96 \\frac{\\sigma}{\\sqrt n})$$\n\n- Suppose we select $M$ different random samples from the population of size $n$, and use them to calculate $M$ different 95% CIs in the same way as above. \n\n- Approximately 95% of these intervals would cover the true $\\mu$ and 5% do not\n\n- [Interactive activity](https://digitalfirst.bfwpub.com/stats_applet/stats_applet_4_ci.html)\n\n## CI interpretation\n\n$$(\\bar X - 1.96 \\frac{\\sigma}{\\sqrt n}, \\bar X + 1.96 \\frac{\\sigma}{\\sqrt n})$$\n\n- ~~\"There is a 95% chance that $\\mu$ lies in the interval\"~~\n\n- This is incorrect!\n\n## CI interpretation\n\n$$(\\bar X - 1.96 \\frac{\\sigma}{\\sqrt n}, \\bar X + 1.96 \\frac{\\sigma}{\\sqrt n})$$\n\n- **Important**: we do not know whether any particular interval is in the 95% of them that cover the mean or the 5% that don't\n\n- Since $\\mu$ is a parameter, it's either in our confidence interval or not\n\n## Other coverage probabilities\n\n$$(\\bar X - 1.96 \\frac{\\sigma}{\\sqrt n}, \\bar X + 1.96 \\frac{\\sigma}{\\sqrt n})$$\n\n$$\\textrm{Point estimate} \\pm \\underbrace{\\textrm{confidence multiplier} \\times \\textrm{standard error}}_{\\text{Margin of error}}$$\n\n- Although 95% CIs are the most common, we can easily generate intervals with other coverage probabilities by adjusting the confidence multiplier\n\n## Other coverage probabilities\n\n- The [confidence multiplier]{style=\"color: RosyBrown\"}, $z^*_{1-\\alpha/2}$, is the z-score that cuts off the upper 100% $\\times \\alpha/2$ of the distribution (the $1-\\alpha/2$ percentile)\n\n- For $\\alpha$ = 0.05, we have a $1-\\alpha/2 = 0.975$, and so $z^*$ is the 97.5$^\\text{th}$ quantile of the standard normal distribution (calculated using software packages)\n\n- Compromising on confidence level to obtain narrower CIs is... highly frowned upon\n\n## When can we use this CI?\n\n$$(\\bar X - z^* \\frac{\\sigma}{\\sqrt n}, \\bar X + z^* \\frac{\\sigma}{\\sqrt n})$$\n\nRemember, this is only ok to use when $\\sigma$ is known, and:\n\n- $X$ is normal\n- $X$ is non-normal, but $n$ is sufficiently large\n\n## What can we do if $\\sigma$ isn't known?\n\n![](images/lec-9/beer.png){width=500}\n\n## What can we do if $\\sigma$ isn't known?\n\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/lec-9/will.jpg)\n:::\n\n::: {.column width=\"50%\"}\n\n- As a Guiness brewery employee, William Sealy Gossett published a paper on the $t$ distribution, which became known as Student's $t$ (the brewery didn't allow him to use his own name)\n\n- A. Student. *The probable error of a mean* (1908)\n:::\n\n:::\n\n## Student's $t$ distribution {.smaller}\n\n::: columns\n::: {.column width=\"40%\"}\n- Gosset used his new distribution to determine how large a sample should be for testing beer\n\n- The $t$ distribution is appropriate for constructing a confidence interval for the mean when $\\sigma$ is unknown\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](lec-9_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n\n\n:::\n\n:::\n\n\n## Student's $t$ distribution {.smaller}\n\n::: columns\n::: {.column width=\"40%\"}\n- The $t$ distribution looks like the normal distribution except it has fatter fails, leading to wider CIs\n\n- This is due to the uncertainty involved in estimating $\\sigma$ by using $s$\n\n- As the sample size increases, $s$ is a better and better estimate of $\\sigma$, and so the $t$ distribution looks more and more like the normal distribution\n:::\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](lec-9_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n\n:::\n\n:::\n\n## Degrees of freedom\n\n- The [degrees of freedom]{style=\"color: RosyBrown\"} of a $t$ distribution tells us how much information is \"available\" for estimating $\\sigma$ using $s$. The random variable\n\n$$t = \\frac{\\bar X - \\mu}{s/ \\sqrt{n}}$$\n\nhas a $t$ distribution with $n-1$ degrees of freedom ($df$), which we denote by $t_{n-1}$ (we lose one $df$ by estimating the sample mean using $\\bar X$). \n\n- The $t$ distribution only has one parameter ($df$)\n\n- How does this compare to the standard normal distribution?\n\n## Two-sided interval with unknown $\\sigma$\n\n$$(\\bar X - t^*_{n-1; 1-\\alpha/2} \\frac{\\sigma}{\\sqrt n}, \\bar X + t^*_{n-1; 1-\\alpha/2} \\frac{\\sigma}{\\sqrt n})$$\n\n## What bout one-sided intervals? {.smaller}\n\n- The symmetric two-sided confidence intervals we have dealt with so far give the shortest intervals with the desired coverage probability (for symmetric distributions)\n\n- Occasionally, we may only want an upper limit or a lower limit for the population mean, for instance in a non-inferiority clinical trial for a generic drug (we don't expect the generic drug to work better, but we do expect it to be \"not worse\")\n\n- How might we construct these types of intervals?",
    "supporting": [
      "lec-9_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}