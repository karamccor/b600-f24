{
  "hash": "145c56f514250d3e5bbce86bc4f7d21e",
  "result": {
    "markdown": "---\ntitle: \"Lecture 2: The nature of data\"\nsubtitle: \"BIOS 600 - Fall 2024\"\nauthor: \"Dr. Kara McCormack\"\nlogo: \"images/logo_600.png\"\nformat: \n  revealjs: \n    theme: slides.scss\n    multiplex: true\n    transition: fade\n    slide-number: true\neditor: visual\nexecute:\n  freeze: auto\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n:::\n\n\n\n## Exploratory data analysis (EDA)\n\n-   Initial data analysis approach that summarizes main characteristics of dataset\n-   Often visual or in the form of basic summary statistics\n\n## Data visualization\n\n-   The creation and study of the visual representation of data\n-   Many tools available (R is popular; many systems within R for data visualization)\n-   Creating visualizations helps us see patterns and identify potential data quality issues\n-   We will focus on **ggplot2**, a component of the **tidyverse**\n\n::: {.callout-note appearance=\"simple\"}\n\"The simple graph has brought more information to the data analyst's mind than any other device.\" - John Tukey\n:::\n\n## ggplot2 in tidyverse\n\n::: columns\n::: {.column width=\"50%\"}\n-   The tidyverse is a group of R packages designed for data science\n-   All tidyverse packages share an underlying design philosophy\n-   Data visualization package in the tidyverse\n-   Inspired by *The Grammar of Graphics* (Wilkinson)\n\n![](images/lec-2/gg.png)\n:::\n\n::: {.column width=\"50%\"}\n![](images/lec-2/ggplot2.png)\n:::\n:::\n\n## What is a Grammar of Graphics?\n\n-   A system allowing for concise description of graphical components\n\n![](images/lec-2/gg.png){width=\"300\"}\n\n## What is a Grammar of Graphics?\n\nA statistical graphic is\n\n-   data (which may be statistically summarized or transformed)\n-   **mapped** to **aesthetic** attributes (color, size, xy-position, etc.)\n-   using **geometries** (points, lines, bars, etc.)\n-   mapped onto a specific **coordinate** and/or **facet** system\n\n# Types of data\n\n## Categorical data\n\n::: columns\n::: {.column width=\"50%\"}\nNominal data\n\n-   Named categories without numeric meaning\n-   Ex: Only two categories: binary or dichotomous\n-   Ex: breast cancer status, blood type, health insurance provider type, education level, etc\n:::\n\n::: {.column width=\"50%\"}\nOrdinal data\n\n-   Ordered categories, but differences between values not easily measured\n-   Relative comparisons made about differences between levels\n-   Stage of colon cancer, Likert scale, frequency of smoking (often, sometimes, rarely, never), etc.\n:::\n:::\n\n## Numerical data\n\n::: columns\n::: {.column width=\"50%\"}\nCount or rank data\n\n-   Discrete counts. Or ranks.\n-   Number of alcoholic drinks consumed in the past week, numerical rank of cancers by mortality, etc.\n:::\n\n::: {.column width=\"50%\"}\nContinuous data\n\n-   Measurable quantities where difference between possible values can be arbitrarily small\n-   Data may lie within a range or be unbounded\n-   Birth weight, BMI, ppm ozone, etc.\n:::\n:::\n\n## Identifying data types\n\n![](images/lec-2/tab1.png){width=\"850\"}\n\n## Complications\n\nIn designing a study, what variable should we use for smoking exposure?\n\n-   Binary variable yes/no?\n-   Ordinal current/former/never smoker?\n-   Discrete number of cigarettes smoked in past week?\n-   Continuous measurement of lifetime pack-years?\n\nIn the real world, decisions are made based on sample size, statistical power, likelihood of measurement error, or simply convenience (this happens a lot!)\n\n## Visualizing CDC data\n\nLet's take a look at some basic visualizations using state-level data collected by CDC. We'll examine the following variables:\n\n-   State (categorical; nominal)\n-   HDI (categorical; ordinal)\n-   Region (categorical; nominal)\n-   Adult obesity % (numerical; continuous)\n-   Adequate aerobic activity % (numerical; continuous)\n\n## Bar charts\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncdc <- read.csv(\"https://www2.stat.duke.edu/courses/Spring21/sta102.001/labs/data/cdc_cleaned.csv\")\n\n# write.csv(cdc, \"C:/Users/kmcco/OneDrive - University of North Carolina at Chapel Hill/Documents/UNC_Teaching/fall2024/bios600-f24/labs/data/cdc_cleaned.csv\")\n```\n:::\n\n\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell fig.asp='1'}\n\n```{.r .cell-code}\nggplot(data = cdc, mapping = aes(x = Region)) + \n  geom_bar(fill = \"steelblue\") + \n  labs(title = \"Number of US States by Census Region\", \n       x = \"Region\", y = \"Count\") + \n  theme(text = element_text(size = 28))\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\" style=\"font-size: 70%;\"}\n-   Summarizes numerical variable by categories\n-   Visually depict frequency distributions for nominal or ordinal data\n-   Bars represent either frequency or relative frequency by category\n-   Separation between bars (non-continuous data)\n-   May contain error bars to indicate estimate variability\n:::\n:::\n\n## Box plots\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell fig.asp='1'}\n\n```{.r .cell-code}\nggplot(data = cdc, aes(x = HDI, y = Obesity)) + geom_boxplot()+ \n  labs(title = \"Adult Obesity (%) by State HDI\", \n       x = \"HDI\", y = \"Adult Obesity (%)\") +\n  theme(text = element_text(size = 28))\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\" style=\"font-size: 70%;\"}\n-   Summarizes numerical variable\n-   Five-number summary: sample minimum, 25th percentile, median, 75th percentile, sample maximum\n-   Outliers\n-   Spread and skew\n-   (More on all these later!)\n:::\n:::\n\n## Histograms\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell fig.asp='1'}\n\n```{.r .cell-code}\nggplot(data = cdc, aes(x = Obesity)) +\n  geom_histogram(color = \"darkblue\", fill = \"lightblue\", binwidth = 2)+ \n  labs(title = \"Distribution of Adult Obesity (%) by State\", \n       x = \"Adult Obesity (%)\", y = \"Count\") +\n  theme(text = element_text(size = 28))\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\" style=\"font-size: 70%;\"}\n-   Summarizes numerical variable\n-   Five-number summary: sample minimum, 25th percentile, median, 75th percentile, sample maximum\n-   Outliers\n-   Spread and skew\n-   (More on all these later!)\n:::\n:::\n\n## Line plots\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell fig.asp='1'}\n\n```{.r .cell-code}\nggplot(data = cdc[1:4,], aes(x = State, y = Obesity, group = 1)) +\n  geom_line() + \n  geom_point() + \n  labs(title = \"Obesity by State\", \n       x = \"State\", y = \"Adult Obesity (%)\")+ \n  theme(text = element_text(size = 28))\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\" style=\"font-size: 70%;\"}\n-   Summarizes numerical variable (most often used across time)\n-   Each value on x-axis corresponds to only one measurement on y-axis (and vice versa)\n-   Often used to depict change over time and connected with line.\n\n::: {.callout-warning title=\"Question\"}\nIs the plot on the left useful?\n:::\n:::\n:::\n\n## Scatterplots\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell fig.asp='1'}\n\n```{.r .cell-code}\ncdc |>\n  ggplot(aes(x = Exercise, y = Obesity)) +\n  geom_point() + \n  facet_grid(. ~ HDI) +\n  ggtitle(\"Adequate aerobic activity \\n associated with lower obesity\") +\n  xlab(\"Adequate aerobic activity (%)\") + \n  theme(text = element_text(size = 28),\n        axis.text = element_text(size = 16))\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\" style=\"font-size: 70%;\"}\n-   Shows relationship between multiple continuous measurements\n\n-   You can add color, shape, transparency, etc to further differentiate by category\n:::\n:::\n\n## Some best practices\n\n-   Keep it simple\n-   Summarize and highlight\n-   Tell a story with the plot (use \"active titles\")\n-   If possible, replace text with visuals\n\n## Reminder: the population vs. a sample {.smaller}\n\n::: columns\n::: {.column width=\"40%\"}\n-   **Population and research question**: Is the PCV13 vaccine effective against community acquired pneumonia in **adults aged 65 or older**?\n\n-   Sample: 84,496 adults 65 years of age or older recruited in a trial between September 2008 and January 2010 and 101 sites throughout the Netherlands.\n:::\n\n::: {.column width=\"60%\"}\n![](images/lec-2/poly.png)\n:::\n:::\n\n## Parameters and statistics\n\n**Statistics**\n\n-   Attribute of a sample\n-   Function of the observed values at hand\n-   Confusingly, both the function and the values\n    -   Example: You take a measurement from a sample of 100 people. The mean measurement of that sample (as a function) is a statistic. The actual realized value of the mean measurement of that sample is also a statistic.\n-   Written in Roman letters\n\n## Parameters and statistics\n\n**Parameters**\n\n-   Attribute of the population of interest\n-   Not computable directly (unless entire population is perfectly measured)\n-   Written in Greek letters\n\nA statistic used to estimate a population parameter is an **estimator**\n\n## Numerical summary statistics {.smaller}\n\n::: columns\n::: {.column width=\"40%\"}\n-   Population **parameter** of interest: vaccine efficacy among all adults aged 65 or older\n\n-   Sample **statistic** collected: proportion of vaccinated adults in the trial who became ill with community-acquired pneumonia\n:::\n\n::: {.column width=\"60%\"}\n![](images/lec-2/poly.png)\n:::\n:::\n\n## Mean {.smaller}\n\n-   **Sample mean**: the arithmetic average of values in the sample:\n\n$$\\bar{x} = \\frac{1}{n}(x_1 + \\ldots + x_n) = \\frac{1}{n} \\sum_{i=1}^n x_i$$\n\n-   Population mean $\\mu$ is calculated the same way, but would involve sum over every observation in the population (rarely possible!)\n\n-   The sample mean is a **point estimate** of the population mean\n\n-   Not the exact population mean (unless lucky), but for a representative sample, it's a pretty good guess\n\n-   As the sample size gets larger, on average $\\bar{x}$ gets closer and closer to $\\mu$\n\n## Median\n\n-   **Sample median**: the $50^{th}$ **percentile**\n\n-   Middle number of observations after being ranked in numerical order\n\n-   For odd number observations, it is the exact middle value; otherwise, it is the arithmetic average of the middle two.\n\n-   Example: What is the median of $\\{3, 4, 5, 5, 7, 8, 9, 9\\}$ ?\n\n-   More **robust** to extreme values or outliers when compared to the mean.\n\n## Mode\n\n-   **Sample mode**: the most frequent value in the dataset\n-   There does not only have to be one mode (we can have bimodal or trimodal or other **multimodal** distributions)\n-   Example: What is the mode of $\\{1, 2, 3, 4, 4, 5, 5, 5, 7, 9\\}$?\n\n## Are point estimates of location enough?\n\n![](images/lec-2/irma.png){width=\"700\"}\n\n## Skewness\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set the seed for reproducibility\nset.seed(123)\n\n# Simulate data from a normal distribution\nnormal_data <- rnorm(400, mean = 0, sd = 1)\n\n# Transform the data to make it right-skewed\nright_skewed_data <- exp(normal_data)\n\n# Create a histogram\nhist(right_skewed_data, breaks = 30,\n     col = \"darkgoldenrod3\", main = \" \", \n     xlab = \"Value\")\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n**Skewed** distributions are not symmetric; they can be right or left skewed depending on which side the \"tail\" is on.\n\n## Minimum, maximum, and range\n\n-   **Sample minimum** and **maximum**: the samlest and largest observations in the dataset\n\n-   **Sample range**: the difference between the sample maximum and the sample minimum\n\n## Quantiles\n\n-   Cutpoints dividing the data into equal-sized groups (tertiles, quartiles, quintiles, percentiles, etc.)\n\n-   First quartile (Q1) and third quartile (Q3) cut off the bottom and top 25%, respectively\n\n-   **Interquartile range** (IQR): Q3-Q1; shows the width of the middle 50% of the data\n\n-   The sample minimum, Q1, Q2 (median), Q3, and maximum are sometimes called the **five number summary**\n\n## Outliers\n\n-   Observations numerically distant from others (definitions vary)\n\n-   Statistical methods robust to outliers (e.g. the median) can be used if outliers are problematic\n\n-   Should be noted and handled carefully! (e.g. maternal ages of 11 vs 111 in a dataset)\n\n## Standard deviation {.smaller}\n\n-   **Sample standard deviation**: most common measure of spread, based on deviations around the mean\n\n$$s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^n (x_i - \\bar{x})^2}$$\n\n-   Population SD $\\sigma$ is calculated the same way, but requires sum over everyone in the population (with $\\bar{x}$ replaced by $\\mu$)\n\n-   Same units as original dataset for easier interpretation\n\n-   Often used to express confidence (e.g. a **margin of error** for a poll being around $\\pm$ 2 SD of the mean)\n\n-   Squared deviations weight larger deviations more heavily, and so also positive and negative deviations do not cancel out\n\n## Variance {.smaller}\n\n-   **Sample variance**: approximately the average squared deviation from the mean\n\n$$s^2 = \\frac{1}{n-1} \\sum_{i=1}^n(x_i - \\bar{x})^2$$\n\n-   Estimate of the population variance $\\sigma^2$\n-   Division by $n-1$ instead of $n$ to avoid bias in small samples\n    -   Don't worry about that right now, more details in a subsequent statistics class if interested\n\n## How big are most values?\n\n-   For a distribution of any shape, most of the data are within \"average $\\pm$ $k$ SDs\"\n\n::: {.callout-note appearance=\"simple\"}\n## Chebyshev's inequality\n\n-   **Chebyshev's inequality** tells us the proportion of values in the range \"average $\\pm$ $k$ SDs\" is at least $1-\\frac{1}{k^2}$\n:::\n\n## Chevychev's bounds\n\n|       Default       |              Left               |\n|:-------------------:|:-------------------------------:|\n| Average $\\pm$ 2 SDs | at least $1-\\frac{1}{4}$ = 75%  |\n| Average $\\pm$ 3 SDs | at least $1-\\frac{1}{9}$ = 89%  |\n| Average $\\pm$ 4 SDs | at least $1-\\frac{1}{16}$ = 94% |\n| Average $\\pm$ 5 SDs | at least $1-\\frac{1}{25}$ = 96% |\n\n-   If we know the exact distribution (coming soon), we can often calculate better bounds\n\n-   However, these bounds hold for *any* distribution (that has a well-defined mean and variance)\n\n## Why not always use means and SDs? {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n# Calculate the mean and standard deviation of the right-skewed distribution\nmean_skewed <- mean(right_skewed_data)\nsd_skewed <- sd(right_skewed_data)\n\n# Simulate a symmetric normal distribution with the same mean and standard deviation\nsymmetric_normal_data <- rnorm(1000, mean = mean_skewed, sd = sd_skewed)\n\n# Create a histogram of the symmetric normal distribution without axes, axis labels, or main title\nhist(right_skewed_data, breaks = 30,\n     col = \"darkgoldenrod3\", main = \" \", \n     xlab = \"Value\")\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(symmetric_normal_data, breaks = 30, ann = FALSE, col = \"darkgoldenrod3\")\n```\n\n::: {.cell-output-display}\n![](lec-2_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n:::\n:::\n\nThese two distributions have the same mean and standard deviation, but are clearly very different!\n\n-   Exploratory data analysis can help us visually see differences in two datasets that basic statistics (e.g. mean and sd) might not reveal\n\n## Recap\n\n-   Exploratory data analysis: initial data analysis that summarizes key aspects of data\n-   Types of data: categorical, numerical\n-   Examples of plots: bar charts, box plots, histograms, etc.\n-   Population vs. sample\n-   Numerical summary statistics: mean, median, mode\n-   Quantiles, outliers, standard deviation vs. variance, Chebyshev's inequality\n",
    "supporting": [
      "lec-2_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}